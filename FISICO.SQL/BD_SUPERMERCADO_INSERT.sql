USE BD_SUPERMEECADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE, SUP_EMAIL,SUP_ENDERECO_LOGRADOURO,SUP_ENDERECO_NUMERO,SUP_ENDERECO_CIDADE,SUP_ENDERECO_ESTADO)
VALUES("123456", "Supermercado Griks","199999999","gricktambau@email.com","Grink Street","100","TambaCity","SP");

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL,SUP_ENDERECO_LOGRADOURO,SUP_ENDERECO_NUMERO,SUP_ENDERECO_CIDADE,SUP_ENDERECO_ESTADO)
VALUES("987654",
"Mercado Bom Preço Eireli",
"18888",
"atendimento@bompreco.com",
"Rua das Flores",
"210",
"Belo Horizonte",
"MG");

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE, SUP_EMAIL,SUP_ENDERECO_LOGRADOURO,SUP_ENDERECO_NUMERO,SUP_ENDERECO_CIDADE,SUP_ENDERECO_ESTADO)
VALUES("12345678",
"Supermercado Estrela Ltda",
"155555",
"contato@estrela.com.br",
"Av. Paulista",
"1500",
"São Paulo",
"SP");

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL,SUP_ENDERECO_LOGRADOURO,SUP_ENDERECO_NUMERO,SUP_ENDERECO_CIDADE,SUP_ENDERECO_ESTADO)
VALUES("45678912",
"Super Vale Distribuidora",
"166666666",
"contato@supervale.com",
"Av. Beira Mar",
"890",
"Florianópolis",
"SC");

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE, SUP_EMAIL,SUP_ENDERECO_LOGRADOURO,SUP_ENDERECO_NUMERO,SUP_ENDERECO_CIDADE,SUP_ENDERECO_ESTADO)
VALUES("23457890",	"HiperMercado Central",	"177777777","sac@hipercentral.com.br",
	"Rua das Palmeiras",	"45",	"Curitiba",	"PR");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,PRO_NOME,PRO_PESO,PRO_QUANTIDADE,PRO_PRECO,PRO_DATA_VALIDADE)
VALUES("789123456",
"Arroz 5kg",
"5.0",
"500",
"26.90",
"2025-12-25"

);

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,PRO_NOME,PRO_PESO,PRO_QUANTIDADE,PRO_PRECO,PRO_DATA_VALIDADE)
VALUES("7891234567890",
"Arroz Branco Tipo 1 5kg",
"5.000",
"100",
"29.90",
"2026-03-15");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,PRO_NOME,PRO_PESO,PRO_QUANTIDADE,PRO_PRECO,PRO_DATA_VALIDADE)
VALUES("7896543210987",
"Feijão Carioca 1kg",
"1.000",
"200",
"8.49",
"2026-05-10");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,PRO_NOME,PRO_PESO,PRO_QUANTIDADE,PRO_PRECO,PRO_DATA_VALIDADE)
VALUES("7893216549870",
"Leite Integral 1L",
"1.000",
"300",
"4.99",
"2025-12-01");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,PRO_NOME,PRO_PESO,PRO_QUANTIDADE,PRO_PRECO,PRO_DATA_VALIDADE)
VALUES("7899876543210",
"Óleo de Soja 900ml",
"0.900",
"150",
"7.59",
"2026-02-20");

INSERT INTO CONSUMIDOR (CON_CPF,
CON_NOME, 
CON_TELEFONE, 
CON_EMAIL)
VALUES("123456","Bruno","1999999","bruno@gamil.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES("98765432100","Maria Silva","19988887777","maria.silva@gmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES("45678912311","João Pereira","19997776655","joao.pereira@hotmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES("32165498722","Ana Costa","19996665544","ana.costa@yahoo.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES("15975346899","Carlos Oliveira","19995554433","carlos.oliveira@gmail.com");

SELECT *FROM CONSUMIDOR;

SELECT *FROM PRODUTO;

SELECT *FROM SUPERMERCADO;

INSERT INTO FUNCIONARIO(FUN_CPF,
FUN_NOME, 
FUN_DATA_NASCIMENTO ,
FUN_TELEFONE,
FUN_EMAIL ,
FUN_CARTEIRA_TRABALHO ,
FUN_BANCO_AGENCIA ,
FUN_BANCO_CONTA ,
FUN_DATA_ADMISSAO ,
FUN_JORNADA_TRABALHO,
FK_SUP_CNPJ)
VALUES("987654321","Jose Vanderlei","1985-03-12","112309221","ze_vanderlei@email.com","carteira_ze_vanderlei.pdf","1234","56789","2020-01-15","44 horas","123456");

INSERT INTO FUNCIONARIO(
FUN_CPF,
FUN_NOME, 
FUN_DATA_NASCIMENTO,
FUN_TELEFONE,
FUN_EMAIL,
FUN_CARTEIRA_TRABALHO,
FUN_BANCO_AGENCIA,
FUN_BANCO_CONTA,
FUN_DATA_ADMISSAO,
FUN_JORNADA_TRABALHO,
FK_SUP_CNPJ)
VALUES("12345678901","Maria Fernanda","1990-07-22","11987654321","maria.fernanda@email.com","carteira_maria.pdf","4321","98765","2019-03-10","44 horas","987654");

INSERT INTO FUNCIONARIO(
FUN_CPF,
FUN_NOME, 
FUN_DATA_NASCIMENTO,
FUN_TELEFONE,
FUN_EMAIL,
FUN_CARTEIRA_TRABALHO,
FUN_BANCO_AGENCIA,
FUN_BANCO_CONTA,
FUN_DATA_ADMISSAO,
FUN_JORNADA_TRABALHO,
FK_SUP_CNPJ)
VALUES("23456789012","Carlos Eduardo","1988-11-05","11999887766","carlos.eduardo@email.com","carteira_carlos.pdf","5678","11223","2021-06-20","40 horas","45678912");

INSERT INTO FUNCIONARIO(
FUN_CPF,
FUN_NOME, 
FUN_DATA_NASCIMENTO,
FUN_TELEFONE,
FUN_EMAIL,
FUN_CARTEIRA_TRABALHO,
FUN_BANCO_AGENCIA,
FUN_BANCO_CONTA,
FUN_DATA_ADMISSAO,
FUN_JORNADA_TRABALHO,
FK_SUP_CNPJ)
VALUES("34567890123","Juliana Alves","1995-02-18","11988776655","juliana.alves@email.com","carteira_juliana.pdf","8765","33445","2022-09-01","36 horas","23457890");

INSERT INTO FUNCIONARIO(
FUN_CPF,
FUN_NOME, 
FUN_DATA_NASCIMENTO,
FUN_TELEFONE,
FUN_EMAIL,
FUN_CARTEIRA_TRABALHO,
FUN_BANCO_AGENCIA,
FUN_BANCO_CONTA,
FUN_DATA_ADMISSAO,
FUN_JORNADA_TRABALHO,
FK_SUP_CNPJ)
VALUES("45678901234","Pedro Henrique","1992-12-30","11977665544","pedro.henrique@email.com","carteira_pedro.pdf","6543","55667","2018-11-25","44 horas","12345678");



CREATE TABLE IF NOT EXISTS SUPERMERCADO_PRODUTO(
	SPR_ID INTEGER AUTO_INCREMENT PRIMARY KEY,
    FK_SUP_CNPJ VARCHAR(15) NOT NULL,
    FK_PRO_ID INTEGER NOT NULL,
	 FOREIGN KEY (FK_SUP_CNPJ) REFERENCES SUPERMERCADO (SUP_CNPJ) ON DELETE CASCADE,
	 FOREIGN KEY (FK_PRO_ID) REFERENCES PRODUTO(PRO_ID) ON DELETE CASCADE
);




CREATE TABLE IF NOT EXISTS SUPERMERCADO_CONSUMIDOR(
	SPR_ID INTEGER AUTO_INCREMENT PRIMARY KEY,
    FK_SUP_CNPJ VARCHAR(15) NOT NULL,
    FK_CON_CPF VARCHAR(11) NOT NULL,
	 FOREIGN KEY (FK_SUP_CNPJ) REFERENCES SUPERMERCADO (SUP_CNPJ) ON DELETE CASCADE,
	 FOREIGN KEY (FK_CON_CPF) REFERENCES CONSUMIDOR (CON_CPF) ON DELETE CASCADE
);
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("123456", 1);
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("12345678", 2);
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("23457890", 3);
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("45678912", 4);
INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("987654", 5);

INSERT INTO SUPERMERCADO_CONSUMIDOR (FK_SUP_CNPJ, FK_CON_CPF) VALUES
("123456", "123456");
INSERT INTO SUPERMERCADO_CONSUMIDOR (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("987654", "98765432100");
INSERT INTO SUPERMERCADO_CONSUMIDOR (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("12345678", "45678912311");
INSERT INTO SUPERMERCADO_CONSUMIDOR (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("45678912", "32165498722");
INSERT INTO SUPERMERCADO_CONSUMIDOR (FK_SUP_CNPJ, FK_PRO_ID) VALUES
("23457890", "15975346899");


SELECT * FROM SUPERMERCADO;
SELECT * FROM PRODUTO;
SELECT * FROM CONSUMIDOR;
SELECT * FROM FUNCIONARIO;
SELECT * FROM SUPERMERCADO_PRODUTO;
SELECT * FROM SUPERMERCADO_CONSUMIDOR;

/*
CONSULTAR O AUMENTO DE R$ 2,00NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$ 5,00
*/

SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE ((PRO_PRECO +2),2) AS "PRECO COM AJUSTE DE R$ 2,00"
FROM PRODUTO
WHERE PRO_PRECO >=5;

/*
CONSULTAR A REDUÇÃO DE R$ 1,00 NO PREÇO DOS PRODUTOS
COM PREÇO ATUAL ABAIXO DE R$5,00
*/

SELECT  PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE ((PRO_PRECO -1),2) AS "PRECO COM REDUÇÃO DE R$ 1,00"
FROM PRODUTO
WHERE PRO_PRECO <=10;

/*
CONSULTAR COMO SERIA APLICARUM DESCONTO DE 10% EM TODOS OS PRODUTOS
*/
SELECT  PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		PRO_PRECO AS "PREÇO ATUAL",
        (PRO_PRECO - (PRO_PRECO *0.1)) AS "PRECO COM DESCONTO DE10%"
FROM PRODUTO;

/*
AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVIDINDO PELA METADE
*/
SELECT 	PRO_ID,
		PRO_NOME ,
		PRO_CODIGO_BARRAS,
		PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO
SET PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE PRO_ID=1;

/*
CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SEMTENBRO DE 2025 E DEZEMBRO DE 2025
*/
SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_DATA_VALIDADE AS "DADA DE VALIDADE"
FROM PRODUTO
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01'AND '2025-12-31';

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM PRECO MAIOR QUE R$ 10 OU MENOR QUE R$ 4*/
SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
        PRO_PRECO AS "PRECO"
FROM PRODUTO
WHERE PRO_PRECO >= 10 OR PRO_PRECO <=4;

/*CONSULTAR OS DDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE*/
SELECT CON_NOME 					AS "NOME DOCONSUMIDOR",
		CON_CPF						AS "CPF DO CONSUMIDOR",
        SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TELEFONE",
		SUBSTRING(CON_TELEFONE,3,9) AS "NUMERO DO TELEFONE"
FROM CONSUMIDOR;

/*GERAR UM FRASE CONCATENANDO RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL*/
SELECT CONCAT("RAZÃO SOCIAL: ",  CONCAT(SUP_RAZAO_SOCIAL, CONCAT(" | CNPJ: ",  CONCAT(SUP_CNPJ, CONCAT(" | TELEFONE: ",  CONCAT(SUP_TELEFONE, CONCAT(" | EMAIL: ",  SUP_EMAIL))))))) AS FRASE
FROM SUPERMERCADO;

/* GERAR UMA CONSULTA QUE VERIFICA O STATUS DO ESTOQUE
REGRAS:
1) QUANTIDADE < 25: ESTOQUE BAIXO
2) QUANTIDADE > 25 E QUANTIDADE <= 100: ESTOQUE MÉDIO
3) QUANTIDADE > 100: ESTOQUE ALTO 
*/

SELECT 	PRO_NOME 			AS "NOME DO PRODUTO",
		PRO_CODIGO_BARRAS 	AS "CÓDIGO DE BARRAS",
        PRO_QUANTIDADE 		AS "QUANTIDADE",
        CASE
			WHEN PRO_QUANTIDADE <=25 THEN "ESTOQUE BAIXO"
            WHEN PRO_QUANTIDADE > 25 AND PRO_QUANTIDADE <=100 THEN "ESTOQUE MÉDIO"
            WHEN PRO_QUANTIDADE > 100 THEN "ESTOQUE ALTO"
		END AS "NÍVEL DE ESTOQUE"
FROM PRODUTO;

/* 
	GERAR UMA CONSULTA BASEADE EM PESO.
    REGRAS:
    1) PESO <= 5: PESO BAIXO;
    2) PESO >5 E PESO <=50: PESO MÉDIO;
    3) PESO >50 : PESO ALTO;
*/ 

SELECT PRO_NOME AS "NOME DO PRODUTO",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_QUANTIDADE AS "QUANTIDADE",
        PRO_DATA_VALIDADE AS "DATA DE VALIDADE",
        PRO_PESO AS "PESO DO PRODUTO",
        CASE
			WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
            WHEN PRO_PESO > 5 AND PRO_PESO <=50 THEN "PESO MÉDIO"
            WHEN PRO_PESO > 50 THEN "PESO ALTO"
		END AS "CLASSIFICAÇÃO PESO"
FROM PRODUTO;

/*CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM CONSUMIDOR;

SELECT COUNT(*)
FROM SUPERMERCADO;

SELECT COUNT(*)
FROM PRODUTO;

SELECT COUNT(*)
FROM FUNCIONARIO;

/*SOMAR O PREÇO TOTALDE TODOS OS PRODUTOS CADASTRADO*/
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;

/*CALCULAR A MEDIA DE PREÇOS DOS PRDUTOS*/
SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(AVG(PRO_PRECO),2)) AS "MEDIA DE PRECO"
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOS CARO*/
SELECT MIN(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR A DATA E HORA ATUAL*/
SELECT NOW() FROM DUAL;

/**/
SELECT FUN_NOME AS "NOMES DO FUNCIONARIO",
		DATE_FORMAT(FUN_DATA_NASCIMENTO,"%d/%m/%Y") AS "DATA DE NASCIMENTO",
        TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO;

/*FUNÇOES MATEMATICAS
ABS - VALOR ABSOLUTO DE UM NÚMERO
REUND - ARREPENDIMENTO
POWER - POTENCIA*/
SELECT ABS(-10),
		ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
        POWER(PRO_PRECO,2) AS "PRECO ELEVADO AO QUADRADO"
FROM PRODUTO;

/*UPPER, LOWER, TRIM*/
SELECT UPPER(FUN_NOME) AS "MAIUSCULAS",
		LOWER(FUN_NOME) AS "MINUSCULAS",
        TRIM("      Bruno") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;











































